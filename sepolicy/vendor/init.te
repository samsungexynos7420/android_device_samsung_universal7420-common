# init.te

allow init efs_block_device:blk_file relabelto;

# Bind mount files on /system
allow init system_file:file mounton;

# Mount EFS on /efs
allow init efs_file:dir  mounton;

# Mount CPEFS on /cpefs
allow init sec_efs_file:dir mounton;

allow init iorapd_data_file:file getattr;

allow init sysfs_scsi_host:dir relabelfrom;
allow init sysfs_scsi_host:file relabelfrom;

# Sockets
allow init socket_device:sock_file { read write getattr setattr create unlink };
allow init node:tcp_socket node_bind;
allow init self:netlink_kobject_uevent_socket { bind create setopt };
allow init dnsproxyd_socket:sock_file write;
allow init fwmarkd_socket:sock_file write;
allow init netd:unix_stream_socket connectto;
allow init port:tcp_socket { name_bind name_connect };
allow init self:tcp_socket { bind connect create write getopt read };

allow init fwk_sensor_hwservice:hwservice_manager find;
allow init hidl_base_hwservice:hwservice_manager add;

# Allow access to /proc/device-tree nodes
r_dir_file(init, proc_dt_firmware)

unix_socket_connect(init, property, rild)

# Proc files
allow init proc_reset_reason:file { rw_file_perms setattr };
allow init proc_vm:file rw_file_perms;
allow init proc_simslot_count:file rw_file_perms;
allow init proc_sec:file { rw_file_perms setattr };

# audidt2allow
allow init default_android_service:service_manager add;
allow init efs_block_device:lnk_file relabelto;
allow init kernel:system module_request;
allow init servicemanager:binder { call transfer };
allow init sysfs_battery_writable:file { open read write };
allow init sysfs_wifi_writable:file { open write };
allow init vendor_file:file execute_no_trans;